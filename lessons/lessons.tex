\documentclass[14pt]{book}

\usepackage[
  a4paper, mag=1000,
  left=2cm, right=1cm, top=2cm, bottom=2cm, headsep=0.7cm, footskip=1.27cm
]{geometry}

\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{cmap}
\usepackage{pscyr} % Нормальные шрифты
\usepackage{amsmath}
\usepackage{tabularx}
\usepackage{array}
\usepackage{multirow}
\usepackage{amssymb}

% Форматирование чисел
\usepackage{siunitx}
\sisetup{range-phrase = \ldots}

% оглавление + ссылки
\usepackage[pdftex]{hyperref}

\hypersetup{%
    pdfborder = {0 0 0},
    colorlinks,
    citecolor=red,
    filecolor=Darkgreen,
    linkcolor=blue,
    urlcolor=blue
}

\usepackage{hypcap}
\usepackage[numbered]{bookmark} % для цифр в закладках в pdf viewer'ов

\usepackage{tocloft}

\renewcommand{\cftsecaftersnum}{.}
\renewcommand{\cftsubsecaftersnum}{.}

\setcounter{tocdepth}{4}
\setcounter{secnumdepth}{4}

\renewcommand\cftsecleader{\cftdotfill{\cftdotsep}}
\renewcommand{\cfttoctitlefont}{\hfill\Large\bfseries}
\renewcommand{\cftaftertoctitle}{\hfill}


% листинги
\usepackage{listings}
\usepackage{color}
\definecolor{commentGreen}{rgb}{0,0.6,0}
\usepackage{caption} % для подписей под листингами и таблиц
%\usepackage[scaled]{beramono}

% графика
\usepackage[pdftex]{graphicx}
\graphicspath{{./fig/}} % папка с изображениями

%\usepackage{setspace} % для полуторного интервала
%\onehalfspacing % сам полуторный интервал

\usepackage{indentfirst} % отступ в первом абзаце

% точки в секция и подсекциях
\usepackage{secdot}
\sectiondot{subsection}

% Подавление висячих строк
\clubpenalty=10000
\widowpenalty=10000

% колонтитулы
%\usepackage{fancybox,fancyhdr}
%\pagestyle{fancy}
%\fancyhf{}
%\fancyhead[C]{\small{C++ and Qt}} % шапка верхнего колонтитула!!!
%\fancyfoot[C]{\small{\thepage}} % шапка нижнего колонтитула!!!

% стили листингов кодов

\lstdefinestyle{CPlusPlus}{
  language=C++,
  basicstyle=\small\ttfamily,
  breakatwhitespace=true,
  breaklines=true,
  showstringspaces=false,
  keywordstyle=\color{blue}\ttfamily,
  stringstyle=\color{red}\ttfamily,
  commentstyle=\color{commentGreen}\ttfamily,
  morecomment=[l][\color{magenta}]{\#},
  numbers=left,
  xleftmargin=1cm
}

\begin{document}

\begingroup
\hypersetup{linkcolor=black}
\tableofcontents
\endgroup

\clearpage

\chapter{Рекуррентные соотношения}

$C_n$, $F_n$

\section{Ханойская башня}

Ханойская башня --- несколько дисков, нанизанных в порядке уменьшения размеров на один из
трех колышков. Задача состоит в том, чтобы переместить всю башню на один из других колышков,
перенося каждый раз только один диск и не помещая больший диск на меньший.
Какое количество перемещений дисков необходимо и достаточно для выполнения задачи?

\textsc{Обозначай и властвуй}: путь $T_n$ --- минимальное число перекладываний, необходимых
для перемещения башни размером $n$ с одного колышка на другой. Очевидно, что $T_1=1$, а $T_2=3$.
Специальный крайний случай --- $T_0=0$, ведь для перемещения башни без дисков вообще ничего делать
не нужно.

Как переместить всю бащню? Эксперементы с тремя дисками показывают, что для такой башни нужно 
сначала переместить два верхних диска на один колышек, потом нижний диск на другой. И уже 
после этого два верхних диска снова перемещаются на самый большой. В общем случае мы сначала
перемещаем $n-1$ меньших дисков на любой из колышков (что требует $T_{n-1}$ перекладываний),
затем перемещаем самый большой диск (одно перекладывание) и, наконец, помещаем $n-1$
меньших дисков обратно на самый большой диск (ещё $T_{n-1}$ перекладываний). 

Таким образом, $n$ дисков (при $n>0$) можно переместить самое большее за $2T_{n-1}+1$
перекладываний. Меньше перекладываний сделать не получится, потому что когда мы хотим
переместить самый большой диск, $n-1$ меньших дисков должны находиться на одном колышке,
а для этого потребуется не меньше $T_{n-1}$ перекладываний.
Несколько раз перекладывать большой диск смысла нет. После его перемещения меньшие диски нужно
переместить на него обратно за $T_{n-1}$ перекладываний. Следовательно,

\begin{equation}
\label{formula-hanoi-rec}
\begin{array}{ll}
T_0 = 0, \\
T_n = 2T_{n-1} + 1 & \text{при } n > 0 \\
\end{array}
\end{equation}

Совокупность равенств типа~\ref{formula-hanoi-rec} называется \emph{рекуррентностью}. Она задается
начальным значением и зависимостью общего члена от предыдущих.

\section{Числа Фибоначчи}
\section{Домино}
\section{Размен}
\section{Число перестановок}
\chapter{Решение рекуррентных соотношений}

Рекуррентность вида~\ref{formula-hanoi-rec} позволяет вычислять $T_n$ для любого $n$, какое мы пожелаем. Но в действительности
никто не захочет пользоваться для вычисления рекуррентностью, когда $n$ велико --- это займёт
слишком много времени. Рекуррентность даёт только косвенную, локальную информацию.
Решение рекуррентного соотношения --- это запись $T_n$ в простой и компактной
<<замкнутой форме>>. Такая запись позволяет вычислить $T_n$ быстро даже при большом $n$.

\section{Метод математической индукции}



\section{? Производящие функции}
\section{? Свертки}
\chapter{Динамическое программирование}
\section{Одномерное динамическое программирование}
Количество способов решения задачи (задача о кузнечике)

Рассмотрим следующую задачу. На числовой прямой сидит кузнечик, который может прыгать вправо на одну или на две единицы. Первоначально кузнечик находится в точке с координатой 0. Определите количество различных маршрутов кузнечика, приводящих его в точку с координатой n.

Наилучшее решение задачи (задача о кузнечике со стоимостями)

Пусть кузнечик прыгает на одну или две точки вперед, а за прыжок в каждую точку необходимо заплатить определенную стоимость, различную для различных точек. Стоимость прыжка в точку i задается значением Price[i] списка Price. Необходимо найти минимальную стоимость маршрута кузнечика из точки 0 в точку n.

\section{Двумерное динамическое программирование}

Рассмотрим шахматную доску в левом верхнем углу которой находится король. Король может перемещаться только вправо, вниз или по диагонали вправо-вниз на одну клетку. Необходимо определить количество различных маршрутов короля, приводящих его в правый нижний угол.

Теперь решим задачу о нахождении маршрута минимальной стоимости из левого верхнего угла в правый нижний, считая что для каждой клетке указана стоимость прохода через эту клетку.

Игры

Рассмотрим игру «Ферзя в угол» для двух игроков. В левом верхнем углу доски размером $n \times m$ 
находится ферзь, который может двигаться только вправо-вниз. Игроки по очереди двигают ферзя, то есть 
за один ход игрок может переместить ферзя либо по вертикали вниз, либо по горизонтали вправо, либо во 
диагонали вправо-вниз. Игрок, который не может сделать ход — проигрывает, иными словами, выигрывает 
игрок, который поставит ферзя в правый нижний угол. Необходимо определить, какой из игроков может 
выиграть в этой игре независимо от ходов другого игрока.

Наибольшая общая подпоследовательность.

Наибольшая возрастающая подпоследовательность.

В банкомате имеется банкноты nn различных номиналов $a_1, a_2, \ldots, a_n$. Клиент хочет получить сумму в $K$ денежных единиц. Необходимо определить, при помощи какого минимального числа банкнот можно выдать эту сумму (а при необходимости восстановления ответа - определить способ выдачи, использующий минимальное число банкнот).

Есть $n$ золотых слитков массами $a_1, a_2, \ldots, a_n$. Какую максимальную массу золота можно унести, если она не может превышать $K$.

ДИСКРЕТНАЯ ЗАДАЧА ОБ УКЛАДКЕ РЮКЗАКА

Следующим обобщением задачи про золотые слитки является <<задача об укладке рюкзака>>. В этой задаче также имеется несколько предметов, для каждого предмета заданы две характеристики: вес $w_i > 0$ и стоимость предмета $p_i > 0$. Необходимо выбрать множество предметов суммарной максимальной стоимости, при этом суммарная масса выбранных предметов должна быть ограничена значением $K$.

\chapter{Перебор и динамическое программирование}

\chapter{Упражнения}
\begin{enumerate}
\item Один эксцентричный коллекционер покрытий при помощи домино $2 \times n$-прямоугольника
платит 4 доллара за каждую вертикально расположенную костяшку и 1 доллар --- за горизонтальную.
Сколько покрытий будут оценены по этому способу ровно в $m$ долларов? Например, для $m=6$ имеем
три решения: |=, =| и ===.

\item Решите рекуррентное соотношение
$$
\begin{array}{ll}
g_0 = 1; \\
g_n = g_{n-1} + 2g_{n-2} + \cdots + ng_0 & n>0
\end{array}
$$

\item Сколько существует способов разместить числа ${1, 2, \ldots , 2n}$ 
в виде массива размера $2 \times n$ так, чтобы и строки и столбцы массива
были упорядочены по возрастанию слева направо и сверху вниз?
Например, для $n=5$ одним из решений будет 
$$\begin{pmatrix}
1 & 2 & 4 & 5 & 8 \\
3 & 6 & 7 & 9 & 10 
\end{pmatrix}$$.

\item Число Бэлла $\varpi_n$ --- число способов разбиения множества из $n$ предметов на подмножества.
      Например, $\varpi_3=5$, поскольку множество $\{1,2,3\}$ можно разбить на такие подмножества:
      $$\{1,2,3\}; \{1,2\}\cup\{3\}; \{1,3\}\cup\{2\}; \{1\}\cup\{2,3\}; \{1\}\cup\{2\}\cup\{3\}; $$
      Найдите выражение для $\varpi_n$.

\item Грабитель врывается в банк и требует $500$ долларов десяти- и двадцатидолларовыми банкнотами.
      Он также желает знать, сколькими способами кассир может дать ему эти деньги.

\item Сколько существует способов построить $2 \times 2 \times n$-колонну из кирпичей
      размера $2 \times 2 \times 1$?
      
\item Космический зонд обнаружил, что органическое вещество на Марсе имеет ДНК, в состав
      которой входят пять символов, обозначаемых $(a, b, c, d, e)$. Четыре пары символов
      --- $cd$, $ce$, $ed$ и $ee$ --- никогда не встречаются в марсианских ДНК.
      Например, цепочка $bbcda$ запрещена, а $bbdca$ --- разрешена.
      Сколько цепочек ДНК длины $n$ может существовать на Марсе?
      Для $n=2$ ответ $21$, поскольку мы различаем левый и правый концы цепочки.

\end{enumerate}

\section{Ответы}
\begin{enumerate}
\item Подставим в производящую функцию $z^4$ вместо | и z вместо -. Получим функцию $1/(1-z^4-z^2)$.
Это похоже на производящую функцию для $T$, однако $z$ заменено на $z^2$. Следовательно, 
ответом будет $0$ для нечетных $m$ и $F_{m/2+1}$ --- для четных.

\item $G(z)=(z/(1-z)^2)G(z)+1$, следовательно 
$$G(z) = \frac{1-2z+z^2}{1-3z+z^2} = 1 + \frac{z}{1-3z+z^2};$$
поэтому имеем $g_n=F_{2n}+[n=0]$.

\item $C_n$. Числа в верхнем ряду соответствуют позициям плюс единиц в последовательности
из $+1$ и $-1$, определяющей <<горную гряду>>; числа нижнего ряда отвечают позициям
минус единиц. Например, приведенный в упражнении массив соответствует
\begin{verbatim}
    /\     
 /\/  \/\  
/        \ 
\end{verbatim}.

\item $\varpi_n = \sum_k C_n^k\varpi_{n-k}$

\item Это задача размена с номиналами монет $10$ и $20$, поэтому $G(z)=(1/(1-z^{10})(1-z^{20})$.

\item Обозначим искомое число $a_n$, а через $b_n$ обозначим разбиение колонны с выемкой размера
      $2 \times 2 \times 1$ вверху. Рассматривая различные варианты расположения видимых сверху
      кирпичей, получим
$$
\begin{array}{ll}
a_n = 2a_{n-1} + 4b_{n-1} + a_{n-2} + [n=0]; \\
b_n = a_{n-1} + b_{n-1}.
\end{array}
$$
      Следовательно, производящие функции удовлетворяют уравнениям $A = 2zA+4zB+z^2A+1$ и
      $B = zA + zB$. Откуда находим $$A(z) = \frac{1-z}{(1+z)(1-4z+z^2)}$$
      $$a_n = \frac{1}{6}(2+\sqrt{3})^{n+1} + \frac{1}{6}(2-\sqrt{3})^{n+1} + \frac{1}{3}(-1)^n$$

\item Пусть $a_n$ --- число цепочек ДНК, которые не заканчиваются на $c$ или $e$, а $b_n$ --- число
      цепочек, заканчивающихся этими символами. Тогда
      $$
      \begin{array}{ll}
      a_n = 3a_{n-1}+2b_{n-1}+[n=0], & b_n = 2a_{n-1} + b_{n-1}, \\
      A(z) = 3zA(z) + 2zB(z) + 1,    & B(z) = 2zA(z) + zB(z), \\
      A(z) = \frac{1-z}{1-4z-z^2},   & B(z) = \frac{2z}{1-4z-z^2}. \\
      \end{array}
      $$
      Общее число цепочек равно $[z^n](1+z)/(1-4z-z^2) = F_{3n+2}$.

\end{enumerate}

\end{document} 
